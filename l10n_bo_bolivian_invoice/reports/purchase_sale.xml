<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="l10n_bo_invoice_purchase_sale_template">
        <t>
            <div style="font-family: Arial, sans-serif !important;">
                <div class="row">
                    <div class="col-4">
                        <div class="text-left" style="font-size: 10px !important;">
                            <strong style="font-size: 15px !important;" t-esc="o.company_id.name"/>
                            <br/>
                            <br/>
                            <span t-esc="o.company_id.name"/>
                            <br/>
                            <span t-field="o.pos_id.branch_office_id.name"/>
                            <br/>
                            <span>
                                No.
                                <t t-esc="o.pos_id.name"/>
                            </span>
                            <br/>
                            <span t-esc="o.pos_id.address"/>
                            <br/>
                            <span>
                                Teléfono: <t t-esc="o.company_id.phone"/>
                            </span>
                            <br/>
                            <span t-field="o.company_id.municipality_id.name"/>
                        </div>
                    </div>
                    <div class="col-4 center" style="padding-top: 10px !important">
                        <div><b style="font-size: 15px !important;">FACTURA</b></div>
                        <div> <span>(Con Derecho a Crédito Fiscal)</span> </div>
                    </div>
                    <div class="col-4">
                        <div class="row  m-0 p-0" style="font-size: 15px !important;">
                            <strong>NIT: <t t-esc="o.company_id.vat"/></strong>
                            <br/>
                            <strong>FACTURA Nº: <t t-esc="o.invoice_number"/></strong>
                            <br/>
                            <span style=" font-size:10px !important;">CÓD. AUTORIZACIÓN: <t t-esc="o.cuf"/></span>
                        </div>
                    </div>
                </div>

                <div class="row" style=" font-size:10px !important;">
                    <div class="col-9">
                        <span>
                            Fecha: <span t-esc="o.get_formatted_datetime()"/> <span t-field="o.meridies"/>
                        </span>
                        <br/>
                        <span>
                            Nombre/Razón Social: <span t-field="o.partner_id.name"/>
                        </span>
                    </div>
                    <div class="col-3">
                        <span>
                            NIT/CI/CEX: <span t-field="o.partner_id.vat"/> <span t-if="o.partner_id.complement"> - <span t-field="o.partner_id.complement"/> </span>
                        </span>
                        <br/>
                        <span>
                            Cod. Cliente: <span t-field="o.partner_id.code"/>
                        </span>
                    </div>
                </div>
<!-- invoice_line_ids[0].siat_service_id.codigoActividad -->
                <!-- <table style="width:100%; border: 1px solid black; font-size: 10x !important;">
                        <tr style="border: 1px solid black; height: 60px;" >
                            <th style="width:130px; text-align:center ">CÓDIGO</th>
                            <th style="width:110px; text-align:center">CANTIDAD</th>
                            <th style="width:100px; text-align:center">UNIDAD DE MEDIDA</th>
                            <th style="width:240px; text-align:center">CONCEPTO</th>
                            <th style="width:110px; text-align:center">PRECIO U.</th>
                            <th style="width:120px; text-align:center">DESCUENTO</th>
                            <th style="text-align:center">SUBTOTAL</th>
                        </tr>
                    <tbody>
                        <t t-foreach="o.invoice_line_ids" t-as="line">
                            <t t-set="numeric_amount">
                                
                                <t t-esc="line.getSubTotal()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                            </t>
                            <tr t-if="line.display_type == 'product' and line.product_id.gif_product == False" > 
                                <td style="padding-left:10px; text-align:center "><span t-field="line.product_id.default_code"/></td> 
                                <td style="text-align: right; text-align:center padding-right:10px; "><span t-field="line.quantity"/></td> 
                                <td style="padding-left:10px;"><span t-field="line.product_uom_id.siat_udm_id.descripcion"/></td> 
                                <td style="padding-left:10px;"><span t-esc="line.getDescription()"/></td> 
                                <td style="text-align: right; padding-right:10px;"><span t-esc="line.getPriceUnit()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" /></td> 
                                <td style="text-align: right; padding-right:10px;"><span t-esc="line.getAmountDiscount()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/></td> 
                                <td style="text-align: right; padding-right:10px;"><span t-esc="numeric_amount"/></td> 
                            </tr>
                        </t>
                    </tbody>
                </table> -->
                <table style="width:100%; font-size: 9px !important; border-collapse: collapse; border: 1px solid black;">
                    <tr style="height: 40px; border: 1px solid black;">
                        <th style="width:10%; text-align:center; border: 1px solid black;">CÓDIGO</th>
                        <th style="width:10%; text-align:center; border: 1px solid black;">CANTIDAD</th>
                        <th style="width:12%; text-align:center; border: 1px solid black;">UNIDAD DE MEDIDA</th>
                        <th style="width:34%; text-align:center; border: 1px solid black;">CONCEPTO</th>
                        <th style="width:11%; text-align:center; border: 1px solid black;">PRECIO U.</th>
                        <th style="width:11%; text-align:center; border: 1px solid black;">DESCUENTO</th>
                        <th style="width:12%; text-align:center; border: 1px solid black;">SUBTOTAL</th>
                        

                    </tr>
                    <tbody>
                        <!-- Buscar la primera línea que tenga siat_service_id -->
                        <t t-set="line_with_siat" t-value="next((l for l in o.invoice_line_ids if l.siat_service_id), None)"/>
                        <tr t-if="line_with_siat">
                            <td colspan="7" style="text-align:left; font-weight: bold; padding: 4px;">
                                Código Actividad SIAT: <span t-esc="line_with_siat.siat_service_id.codigoActividad"/>
                            </td>
                        </tr>
                        <t t-foreach="o.invoice_line_ids" t-as="line">
                           
                            <t t-set="numeric_amount">
                                <t t-esc="line.getSubTotal()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                            </t>
                            <tr t-if="line.display_type == 'product' and line.product_id.gif_product == False" style="border: 1px solid black;"> 
                                <td style="text-align:center; padding: 2px; border: 1px solid black;">
                                    <span t-field="line.product_id.default_code"/>
                                </td> 
                                <td style="text-align:center; padding: 2px; border: 1px solid black;">
                                    <span t-field="line.quantity"/>
                                </td> 
                                <td style="text-align:left; padding: 2px; border: 1px solid black;">
                                    <span t-field="line.product_uom_id.siat_udm_id.descripcion"/>
                                </td> 
                                <td style="text-align:left; padding: 2px; border: 1px solid black;">
                                    <span t-esc="line.getDescription()"/>
                                </td> 
                                <td style="text-align:right; padding: 2px; border: 1px solid black;">
                                    <span t-esc="line.getPriceUnit()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                                </td> 
                                <td style="text-align:right; padding: 2px; border: 1px solid black;">
                                    <span t-esc="line.getAmountDiscount()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                </td> 
                                <td style="text-align:right; padding: 2px; border: 1px solid black;">
                                    <span t-esc="numeric_amount"/>
                                </td> 
                                
                            </tr>
                        </t>
                    </tbody>
                </table>
                
                <div class="clearfix">
                    <div id="total">
                        <table class="table table-sm" style="width:100%; border: 1px solid white; font-size: 10px !important;">
                            <tr>
                                <td rowspan="7" style="width:580px; ">
                                    <b style="padding-left: 120px">Son: <span t-esc="o.getBolivianLiteral()"/> Bolivianos</b>
                                    <br/>
                                    <img t-att-src="'data:image/png;base64,' + str(o.generate_qr())" width="120" height="120"/>
                                </td>
                                <td style="text-align: right; padding-right:10px;">
                                    <div class="row">
                                        <div class="col" style="text-align: right; padding-right:10px;">
                                            SUBTOTAL Bs <span t-esc="o.getAmountSubTotal()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                            <br/>
                                            DESCUENTO Bs <span t-esc="o.getAmountDiscount()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                            <br/>
                                            TOTAL Bs <span t-esc="o.getAmountTotal()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                            <br/>
                                            MONTO GIFT CARD Bs <span t-esc="o.getAmountGiftCard()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                            <br/>
                                            MONTO A PAGAR Bs <span t-esc="o.getAmountOnIva()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                            <br/>
                                            IMPORTE BASE CREDITO FISCAL Bs <span t-esc="o.getAmountOnIva()" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                            
                    </div>
                </div>
                
                <div class="clearfix">
                    <div id="total">
                        <div style="font-size: 9px !important;  text-align: center; page-break-before: auto; page-break-inside: avoid; page-break-after: auto;">
                            ESTA FACTURA CONTRIBUYE AL DESARROLLO DEL PAÍS, EL USO ILÍCITO SERÁ SANCIONADO PENALMENTE DE ACUERDO A LEY
                            <br/>
                            <span t-field="o.legend_id.descripcionLeyenda"/>
                            <br/>
                            <span t-field="o.pos_id.emision_id.legend"/>
                            
                        </div>
                    </div>  
                </div>
            </div>
        </t>
    </template>
</odoo>
